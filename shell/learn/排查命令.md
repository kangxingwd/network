
# 查看进程所在 cpu
```s
top
# 按 1， 可以看到所有 cpu 信息
# 按 f， 然后 上下， 选择到 P， 点击 空格 选中， 最后 ESC 退出
```

# 查看线程相关
```s
ps -T -p <pid>
top -H  # 或者， top 页面 按 H
top -H -p <pid>
    Shift+H （进程和线程切换显示）

pstree -p
pstree -p |wc -l

# proc
cat /proc/17592/status | grep Threads

prtstat 10186

ls -l /proc/8034/task/

# 其他
top
    -P  # cpu 排序
    -M  # 内存排序

Htop
```

```s
# 按内存升序
ps aux --sort=+rss
# 按内存降序
ps aux --sort=-rss

ps aux --sort=+%cpu
ps aux --sort=-%cpu

# 所有进程内存占用, rss 包含共享库， 所以这个统计偏大
ps aux  | awk 'BEGIN{sum=0}{sum+=$6}END{print sum}'
ps aux  | awk '{sum+=$6}END{print sum}'

lsmod  | awk 'BEGIN{sum=0}{sum+=$2}END{print sum}'

awk 'BEGIN{sum=0}{sum+=$6}END{print sum}' test1.log


used = 所有进程内存 + 申请的大页内存 （大页内存不在 RSS 中）
    所有进程内存:   ps aux  | awk 'BEGIN{sum=0}{sum+=$6}END{print sum}'
    申请的大页内存: cat /proc/meminfo | grep -E "HugePages_Total|Hugepagesize" | awk 'BEGIN{sum=1}{sum*=$2}END{print sum}'

a=`ps aux  | awk 'BEGIN{sum=0}{sum+=$6}END{print sum}'`;b=`cat /proc/meminfo | grep -E "HugePages_Total|Hugepagesize" | awk 'BEGIN{sum=1}{sum*=$2}END{print sum}'`; echo "$((a+b))"


/proc/sys/vm/nr_hugepages
/sys/kernel/mm/hugepages/hugepages-2048kB/nr_hugepages

默认每页 2048KB

内存    页数
2       256
4       512
8       1024
16      2048
24      4096
32      5020
```







